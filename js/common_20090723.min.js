var SweetAndSour=(function(){var n;var t;var r=0;var e=0;var c=0;var d=false;function b(C,A,x,z){if(C.length>A){if(!x){var x=" ..."}if(!z){z=12}var B=C.substring(0,A-x.length);var v;var w;for(var y=0;y<z;y++){if(y<B.length){w=B.length-y;v=B.charAt(w);if(/\s/i.test(v)){return B.substring(0,w)+x}}}return B+x}else{return C}}function l(){var w=0;var v=0;if(self.pageYOffset){w=self.pageXOffset;v=self.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){w=document.documentElement.scrollLeft;v=document.documentElement.scrollTop}else{if(document.body){w=document.body.scrollLeft;v=document.body.scrollTop}}}return({x:w,y:v})}function m(x){var w=0;var v=0;if(x&&x.offsetParent){w=x.offsetLeft;v=x.offsetTop;while(x=x.offsetParent){w+=x.offsetLeft;v+=x.offsetTop}}return({x:w,y:v})}function j(w){var v=document.cookie.indexOf(w);if(v==-1){return null}else{var z=v+w.length+1;var x=document.cookie.indexOf(";",z+1);if(x==-1){x=document.cookie.length}var y=document.cookie.substring(z,x);return y}}function k(){window.clearTimeout(c);c=window.setTimeout(q,200)}function q(){var C=m(n);var A=C.x;var y=C.y;var x=l();var w=Number(x.x)+Number(e);var v=Number(x.y)+Number(r);var B=(w-A);var z=(v-y);if(B!=0||z!=0){n.style.left=(A+B)+"px";n.style.top=(y+z)+"px"}}function g(){var w=j("windowPosition");var v=l();if(w!=null){e=w.split(":")[0];r=w.split(":")[1]}else{var x=m(n);e=x.x-v.x;r=x.y-v.y}n.style.left=Number(v.x)+Number(e)+"px";n.style.top=Number(v.y)+Number(r)+"px"}function u(){var y=m(n);var w=l();e=y.x-w.x;r=y.y-w.y;if(r<10){r=10}var v=new Date();v.setFullYear(v.getFullYear()+1);var x="windowPosition="+e+":"+r+"; expires= "+v.toGMTString()+"; path=/";document.cookie=x}function a(){var x=n.offsetWidth;var w=n.getElement("div.clientArea");var z=w.offsetHeight;n.style.height="auto";w.style.width="auto";var v=new Date();v.setFullYear(v.getFullYear()+1);var y="windowSize="+x+":"+z+"; expires= "+v.toGMTString()+"; path=/";document.cookie=y}function p(){var w=n.getElement("div.clientArea");n.style.height="auto";w.style.width="auto";var v=j("windowSize");if(v!=null){n.style.width=v.split(":")[0]+"px";w.style.height=v.split(":")[1]+"px"}else{if(screen.availWidth<1000){n.style.width="760px";w.style.height="455px"}}}function s(){var v=n.getElement("div.dragBarLeft");var y=n.getElement("div.dragBarBottom");var w=n.getElement("div.dragBarRight");var x=n.getSize();v.style.height=(x.y-4)+"px";y.style.width=(x.x-4)+"px";w.style.height=(x.y-4)+"px"}function f(){var x=document.createElement("div");x.id="overlay";$("menuWrapper").appendChild(x);var y=document.createElement("div");y.id="loading";var w=document.createElement("img");w.src="../images/loading_20080830.gif";w.setAttribute("alt","Just a moment ...");var v=document.createElement("p");v.innerHTML="Just a moment &hellip;";y.appendChild(w);y.appendChild(v);$("menuWrapper").appendChild(y)}function o(){var v=$("imageMenu").getElements("a");v.each(function(x,w){x.addEvent("click",function(){$("overlay").style.display="block";$("loading").style.display="block";IMSubNav.activate1=null;IMSubNav.reset1=null;IMSubNav.activate2=null;IMSubNav.reset2=null})})}function h(y){var v,A,z,x,w;y.each(function(B){A=B.getElements("div.photoBox");z=A.length;A.each(function(E,D){if(((D+1)%3==0)&&(D!=z-1)){var C=new Element("br",{clear:"all"});C.inject(E,"after")}})})}function i(v){var w=v.target;if(w.innerHTML.indexOf("Show")==0){w.innerHTML=w.innerHTML.replace(/Show/,"Hide");w.parentNode.parentNode.getElement("div.listing").style.display="block"}else{w.innerHTML=w.innerHTML.replace(/Hide/,"Show");w.parentNode.parentNode.getElement("div.listing").style.display="none"}}return{initialize:function(){if(Browser.Engine.trident||Browser.Engine.presto){var A=new Element("span",{id:"bgTopLeft"}).addClass("roundedCorner");var y=new Element("span",{id:"bgTopRight"}).addClass("roundedCorner");var E=new Element("span",{id:"bgBottomLeft"}).addClass("roundedCorner");var B=new Element("span",{id:"bgBottomRight"}).addClass("roundedCorner");var C=$$("div.page")[0];C.appendChild(A);C.appendChild(y);C.appendChild(E);C.appendChild(B)}n=$("photoFrame");t=n.getElement("div.clientArea");g();p();var v=new Drag("photoFrame",{handle:$("photoFrame").getElement("div.titleBar"),onComplete:u});var z=n.makeResizable({handle:$("photoFrame").getElement("div.dragBarRight"),modifiers:{x:"width",y:null},onComplete:function(){a();s()}});var w=t.makeResizable({handle:$("photoFrame").getElement("div.dragBarBottom"),modifiers:{x:null,y:"height"},onComplete:function(){a();s()}});var F=n.makeResizable({handle:$("photoFrame").getElement("img.dragHandle"),onComplete:function(){a();s()}});var G=t.makeResizable({handle:$("photoFrame").getElement("img.dragHandle")});var D=n.getElement("div.titleBar a");D.addEvent("mousedown",function(){D.className="btnDown";n.style.display="none";$("photoContent").set("text","");window.setTimeout(function(){D.className=""},1000);$("search").style.visibility="visible"});D.addEvent("mouseup",function(){D.className=""});window.addEvent("scroll",k);if($("imageMenu")){f();o()}var x=$$("div.photoAlbum");if(x.length>0){h(x)}},ajaxPopup:function(w,x){$("photoContent").set("text","");var v=new Request.HTML({url:w,onSuccess:function(y){$("photoContent").adopt(y)},onFailure:function(){$("photoContent").set("text","The request failed.")}});v.send();$("photoFrame").getElement("span.titleBarText").innerHTML=unescape(x);$("photoFrame").style.display="block";s();$("search").style.visibility="hidden"},getPhoto:function(w,v,x){var z=screen.availWidth;if(z<800){var B=screen.availHeight;newURL="../imageMgt/index.php?fuseAction=showPhotoAndCaption&photoName="+w+(x?"&panorama=true":"");newWindow=window.open(newURL,"newWindow","width="+z+",height="+B+",left=0,top=0,dependant=yes,directories=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no");newWindow.focus()}else{var y="../imageMgt/index.php?fuseAction=showPhotoAndCaptionAjax&photoName="+w+(x?"&panorama=true":"");var A=b(v,60," ...",10);this.ajaxPopup(y,A)}},popup:function(y,x,C,B){if(!B){B="resizable=yes,scrollbars=yes"}var v=(screen.width-x)/2;var A=(screen.height-C)/2;B+=((B)?",":"")+"width="+x+",height="+C+",left="+v+",top="+A;var z;if(typeof(y)=="string"){z=y}else{if(typeof(y)=="object"&&y.tagName.toLowerCase()=="a"){z=y.href}}if(z){if(D){D.location.href=z}else{var D=window.open(z,"win",B)}D.focus();return false}},prepareCodeDisplay:function(){var v=$$("div.codeBlock");v.each(function(y,x){var w=y.getElement("h4");var A=new Element("a",{href:"javascript:void(0)",html:"Show "+w.innerHTML,events:{click:function(B){i(B)}}});w.innerHTML="";w.appendChild(A);var z=y.getElement("div.listing");z.style.display="none"})}}})();window.addEvent("domready",SweetAndSour.initialize);google.load("search","1.0",{language:"en"});function OnLoad(){var e=new google.search.SearchControl();var c=new google.search.WebSearch();c.setSiteRestriction("sweetandsour.org");c.setUserDefinedLabel("Sweet &amp; Sour articles");var b=new google.search.SearcherOptions();b.setExpandMode(google.search.SearchControl.EXPAND_MODE_OPEN);e.addSearcher(c,b);e.setSearchStartingCallback(this,function(h,g,f){SearchAdditions.searchStart()});e.setSearchCompleteCallback(this,function(g,f){SearchAdditions.searchComplete(g,f)});var d=new google.search.DrawOptions();d.setSearchFormRoot(document.getElementById("searchControl"));d.setDrawMode(google.search.SearchControl.DRAW_MODE_LINEAR);e.draw(document.getElementById("searchResults"),d);var a=$("searchControl").getElement("div.gsc-clear-button");$("searchControl").getElement("td.gsc-clear-button").removeChild(a);$("searchResults").getElement("table.gsc-resultsHeader td.gsc-configLabelCell").appendChild(a);a.addEvent("click",function(f){SearchAdditions.closeResults(f)})}google.setOnLoadCallback(OnLoad,true);var SearchAdditions={webSearchDone:false,imgSearchDone:false,searchStart:function(){webSearchDone=false;imgSearchDone=false},searchComplete:function(b,a){if(a.results&&a.results.length>0){if(a.results[0].GsearchResultClass=="GwebSearch"){webSearchDone=true}if(webSearchDone){$("searchResults").style.display="block"}}},showResults:function(a){$("searchResults").style.display="block"},closeResults:function(a){$("searchResults").style.display="none"}};