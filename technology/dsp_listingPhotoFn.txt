&lt;? /*
act_setPhotoFunction.php

Puts a photo and caption on the page using absolute positioning.  By default, the photo 
is placed at 20 pixels right and 20 pixels down. Also by default, if the photo is narrower
than a treshold value set below, the caption will be placed to the right of the
photo; if it is wider, the caption will be placed below the photo.

However, if the variable &quot;forceCapBelow&quot; is &quot;true&quot;, the caption is placed below the photo 
regardless of width.  This is appropriate if a smaller photo is to be followed be a lot 
of text. Without this option, all the text would be forced into a relatively narrow (180px) 
wide column to the right of the photo.

Main use is to be called by dsp_photoAndCaption.php which will place a single photo on a 
blank page.  This is convenient since the database holds the link from thumbnails to the 
full-size version and the act_setThumbnailFunction.php generates the link automatically 
to dsp_photoAndCaption.php.

The function can also be called directly from other pages if more than one photo needs to 
be placed on a page.

Variables:
=&gt;| $photoName
=&gt;| imageX
=&gt;| imageY
=&gt;| forceCapBelow (optional - &quot;true&quot;/&quot;false&quot;, defaults to &quot;false&quot;)
*/

function setPhoto($photoName, $imageX, $imageY, $forceCapBelow=&quot;false&quot;) {

	//First set threshold where caption is placed below or to the right of the photo.
	$threshold = 600;

	//Find the folder and caption for this photo (won't be using linkedImg which will also be returned but should be empty).
	$photoInfoFound = false;
	include '../imageMgt/qry_photoInfo.php';

	if($photoInfoFound == true) {
		//Get the size (height and width) of the photo and the url where it can be found.
		include '../imageMgt/act_getSizeAndURL.php';

		//Calculate size and positions of border and drop-shadow
		$rectangleWidth = $width + 4;
		$rectangleHeight = $height + 4;
		$borderX = $imageX - 2;
		$borderY = $imageY - 2;
		$shadowX = $imageX + 4;
		$shadowY = $imageY + 4;

		//Determine position and width of box containing the caption

		if($forceCapBelow == &quot;true&quot;) {
			$captionPosition = &quot;below&quot;;  //Caption below photo
		}
		else {
			if($width &gt; $threshold)
				$captionPosition = &quot;below&quot;;  //Caption below photo
			else
				$captionPosition = &quot;right&quot;;  //Caption to the right of the photo
		}

		if($captionPosition == &quot;below&quot;) {  //Caption below photo
			$captionX     = $borderX;
			$captionY     = $borderY + $rectangleHeight + 16;
			if($forceCapBelow == &quot;true&quot;)
				$captionWidth = 600;
			else
				$captionWidth = $width;
		}
		else {  //Caption to the right of the photo
			$captionX     = $borderX + $rectangleWidth + 16;
			$captionY     = $borderY;
			$captionWidth = 180;
		}

		//Shadow
		echo &quot;&lt;div style='position:absolute; left:&quot; . $shadowX . &quot;px; top:&quot; . $shadowY . &quot;px; width:&quot; . $rectangleWidth . &quot;px; height:&quot; . $rectangleHeight . &quot;px'&gt;&quot;;
		echo &quot;   &lt;img src='../imageMgt/gray1px.gif' width=&quot; . $rectangleWidth . &quot; height=&quot; . $rectangleHeight . &quot; border=0&gt;&quot;;
		echo &quot;&lt;/div&gt;&quot;;

		//Border
		echo &quot;&lt;div style='position:absolute; left:&quot; . $borderX . &quot;px; top:&quot; . $borderY . &quot;px; width:&quot; . $rectangleWidth . &quot;px; height:&quot; . $rectangleHeight . &quot;px'&gt;&quot;;
		echo &quot;   &lt;img src='../imageMgt/black1px.gif' width=&quot; . $rectangleWidth . &quot; height=&quot; . $rectangleHeight . &quot; border=0&gt;&quot;;
		echo &quot;&lt;/div&gt;&quot;;

		//Image
		if($photoInfoFound == true) {
			echo &quot;&lt;div style='position:absolute; left:&quot; . $imageX . &quot;px; top:&quot; . $imageY . &quot;px; width:&quot; . $width . &quot;px; height:&quot; . $height . &quot;px'&gt;&quot;;
			echo &quot;   &lt;img src='&quot; . $url . &quot;' width=&quot; . $width . &quot; height=&quot; . $height . &quot; border=0&gt;&quot;;
			echo &quot;&lt;/div&gt;&quot;;
		}
		else {
			$caption = $photoName . &quot;could not be found.&quot;;
		}
		//Image
		echo &quot;&lt;div style='position:absolute; left:&quot; . $imageX . &quot;px; top:&quot; . $imageY . &quot;px; width:&quot; . $width . &quot;px; height:&quot; . $height . &quot;px'&gt;&quot;;
		echo &quot;   &lt;img src='&quot; . $url . &quot;' width=&quot; . $width . &quot; height=&quot; . $height . &quot; border=0&gt;&quot;;
		echo &quot;&lt;/div&gt;&quot;;

		//Caption
		echo &quot;&lt;div style='position:absolute; left:&quot; . $captionX . &quot;px; top:&quot; . $captionY . &quot;px; width:&quot; . $captionWidth . &quot;'&gt;&quot;;
		echo &quot;   &lt;table border=0 cellpadding=0 cellspacing=0 width=&quot; . $captionWidth . &quot;&gt;&quot;;
		echo &quot;      &lt;tr&gt;&lt;td&gt;&quot; . $caption . &quot;&lt;/td&gt;&lt;/tr&gt;&quot;;
		echo &quot;   &lt;/table&gt;&quot;;
		echo &quot;&lt;/div&gt;&quot;;
	}
	else {
		echo &quot;Sorry, &quot; . $photoName . &quot; could not be found.&quot;;
	}
}

?&gt;
