&lt;? /*
act_setThumbnailFunction.php

This function uses absolute positioning to place a photo on the page in a 
specified location and places behind it two rectangles to give the illusion of
a drop shadow and a black border. A caption taken from the database is placed
under the photo and if the linkedImg indicated by the database is not an empty
string, the photo is placed between anchor tags.

Must be called from a subdirectory or the paths for the included files are wrong.

Note that if linkedImg obtained from the database by qry_photoInfo.php is not an empty
string, it is assumed to be for a thumbnail that will be linked to a larger image in 
the same directory.  The database stores only the name of that image and the link is 
constructed below so that both the image and its caption are displayed.  It is possible
to override this URL if necessary when the function is called.

=&gt;| photoName     name of the photo
=&gt;| x             position left in pixels
=&gt;| y             position right in pixels
=&gt;| overrideURL   optional - can be used to override the URL carried in the DB.
=&gt;| forceCapBelow	optional - &quot;true&quot;/&quot;false&quot;. Can be be used to force caption 
						below photo; by default, caption placed to right of smaller
						photos. Applies only where overrideURL is &quot;&quot; so if wanting to
						force caption below, must specify overrideURL as &quot;&quot; thus will
						normally call as:
							setThumbnail(&quot;somePhoto.jpg&quot;, 620, 120);
						to link to photo specified in the &quot;photo&quot; table but may call:
							setThumbnail(&quot;somePhoto.jpg&quot;, 620, 120, &quot;http://www.somewhereElse.com&quot;);
						or:
							setThumbnail(&quot;somePhoto.jpg&quot;, 620, 120, &quot;&quot;, &quot;true&quot;);.
*/

function setThumbnail($photoName, $x, $y, $overrideURL = &quot;&quot;, $forceCapBelow = &quot;false&quot;) {
	//Find the information related to this photo
	$photoInfoFound = false;
	include '../imageMgt/qry_photoInfo.php';     //Returns photoInfoFound, folderID, folderName, linkedImg, caption

	include '../imageMgt/act_getSizeAndURL.php'; //Returns url, width, height

	//If necessary, override the url for the link
	if($overrideURL != &quot;&quot;) {
		$linkURL = $overrideURL;
	}
	else {
		if($linkedImg == &quot;&quot;)
			$linkURL = &quot;&quot;;
		else
			$linkURL = &quot;../imageMgt/index.php?fuseAction=showPhotoAndCaption&photoName=&quot; . $linkedImg . &quot;&forceCapBelow=&quot; . $forceCapBelow;
	}
	//Calculate positions
	$rectangleWidth = $width + 4;
	$rectangleHeight = $height + 4;
	$borderX = $x;
	$borderY = $y;
	$imageX  = $x + 2;
	$imageY  = $y + 2;
	$shadowX = $x + 6;
	$shadowY = $y + 6;
	$captionX = $x;
	$captionY = $y + $rectangleHeight + 12;

	//Shadow
	echo &quot;&lt;div style='position:absolute; left:&quot; . $shadowX . &quot;px; top:&quot; . $shadowY . &quot;px; width:&quot; . $rectangleWidth . &quot;px; height:&quot; . $rectangleHeight . &quot;px'&gt;&quot;;
	echo &quot;   &lt;img src='../imageMgt/gray1px.gif' width=&quot; . $rectangleWidth . &quot; height=&quot; . $rectangleHeight . &quot; border=0&gt;&quot;;
	echo &quot;&lt;/div&gt;&quot;;
		
	//Border
	echo &quot;&lt;div style='position:absolute; left:&quot; . $borderX . &quot;px; top:&quot; . $borderY . &quot;px; width:&quot; . $rectangleWidth . &quot;px; height:&quot; . $rectangleHeight . &quot;px'&gt;&quot;;
	echo &quot;   &lt;img src='../imageMgt/black1px.gif' width=&quot; . $rectangleWidth . &quot; height=&quot; . $rectangleHeight . &quot; border=0&gt;&quot;;
	echo &quot;&lt;/div&gt;&quot;;
	
	//Image
	if($photoInfoFound == true) {
		echo &quot;&lt;div style='position:absolute; left:&quot; . $imageX . &quot;px; top:&quot; . $imageY . &quot;px; width:&quot; . $width . &quot;px; height:&quot; . $height . &quot;px'&gt;&quot;;
		if($linkURL != &quot;&quot;)
			echo &quot;   &lt;a href='&quot; . $linkURL . &quot;'&gt;&quot;;
		echo &quot;      &lt;img src='&quot; . $url . &quot;' width=&quot; . $width . &quot; height=&quot; . $height . &quot; border=0&gt;&quot;;
		if($linkURL != &quot;&quot;)
			echo &quot;   &lt;/a&gt;&quot;;
		echo &quot;&lt;/div&gt;&quot;;
	}
	else {
		$caption = $photoName . &quot;could not be found.&quot;;
	}
	
	//Caption
	echo &quot;&lt;div style='position:absolute; left:&quot; . $captionX . &quot;px; top:&quot; . $captionY . &quot;px; width:156'&gt;&quot;;
	echo &quot;   &lt;table border=0 cellpadding=0 cellspacing=0 width=156&gt;&quot;;
	echo &quot;      &lt;tr&gt;&lt;td&gt;&lt;p class=caption&gt;&quot; . $caption . &quot;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&quot;;
	echo &quot;   &lt;/table&gt;&quot;;
	echo &quot;&lt;/div&gt;&quot;;
}
?&gt;
